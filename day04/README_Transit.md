# STEP class 4: Transit

## Name: Ray Oshikawa

## 調べたこと

- Dijkstraにより、任意の二頂点間の最短経路を求める
- 頂点の媒介中心性を求めることにより、多くの人が通りそうな駅（重要な駅）を求める
- 辺の媒介中心性を用いてクラスタリングを行う

媒介中心性についての詳しい説明はREADME_SNS.md参照。

## 実行方法

1. ソースコードを置いたフォルダの中にフォルダ"transit_links"を作り、その下に"edges.txt"と"stations.txt"を置きます
2. `$python3 transit_graph.py`　を実行します

## 結果

以下のようになります。

最も中心媒介性が高い、つまり「任意の二駅の間を最短経路をたどって結んだ時その上にある可能性が最も高い駅」は「**大手町**」でした。新宿とか渋谷とかの方が栄えている印象があるのですが、大手町経由でないといけない小さな駅が多いのかなと思いました（東京の地理に詳しくないのでよくわかりませんが）。

クラスタリングについては、同じ路線が運行しているまたは位置が近い駅が同じクラスタに分類されました。例えば、最後のグループは主に東京地下鉄東西線、中央総武線の駅が分類されています。（住友不動産のページを見たところ多くの駅が浦安営業センターの管轄になっていたのでそこら辺だと思います。）

```
=====TEST start=====
['新宿', '新宿三丁目', '新宿御苑前', '四谷三丁目', '四ツ谷'] 6 分
そのような駅は存在しません -1 分
['千葉', '西千葉', '稲毛', '新検見川', '幕張', '幕張本郷', '津田沼', '東船橋', '船橋', '西船橋', '下総中山', '本八幡', '市川', '小岩', '新小岩', '平井', '亀戸', '錦糸町', '両国', '浅草橋', '秋葉原', '御茶ノ水', '本郷三丁目', '春日', '白山', '千石', '巣鴨', '駒込', '西ケ原', '王子', '王子神谷', '志茂', '赤羽岩淵'] 78 分
=====TEST end=====
最も媒介中心性が高い駅を見つけました
大手町
終着点の媒介中心性は必ず0になっているはずである。
「三鷹」の媒介中心性 0
10グループに分割してみる
10 groups:
['篠崎', '瑞江', '本八幡', '一之江', '市川', '下総中山', '船堀', '小岩', '東大島', '新小岩', '大島', '平井', '西大島', '亀戸']
['菊川', '森下', '住吉', '両国', '浜町', '錦糸町', '浅草橋', '蔵前', '馬喰横山', '押上〈スカイツリー前〉', '東日本橋', '新御徒町', '浅草', '岩本町', '上野御徒町', '田原町', '本所吾妻橋', '小川町', '稲荷町', '押上（スカイツリー前）', '神保町']
['市ヶ谷', '曙橋', '九段下', '新宿三丁目', '竹橋', '半蔵門', '新宿御苑前', '北参道', '永田町', '四谷三丁目', '明治神宮前〈原宿〉', '麹町', '青山一丁目', '溜池山王', '四ツ谷', '代々木公園', '表参道', '渋谷', '市ケ谷', '赤坂見附', '国立競技場', '六本木', '六本木一丁目', '信濃町', '代々木上原', '外苑前', '乃木坂', '恵比寿', '原宿', '国会議事堂前', '代々木', '広尾', '麻布十番', '千駄ケ谷', '赤坂', '目黒', '中目黒', '白金高輪', '白金台']
['西高島平', '新高島平', '高島平', '西台', '蓮根', '志村三丁目', '志村坂上', '本蓮沼', '板橋本町', '板橋区役所前', '新板橋', '西巣鴨']
['千石', '白山', '巣鴨', '春日', '大塚', '駒込', '本郷三丁目', '飯田橋', '水道橋', '池袋', '田端', '本駒込', '西ケ原', '御茶ノ水', '後楽園', '江戸川橋', '新大塚', '要町', '東池袋', '東大前', '王子', '淡路町', '茗荷谷', '護国寺', '千川', '王子神谷', '小竹向原', '志茂', '氷川台', '赤羽岩淵', '平和台', '地下鉄赤塚', '地下鉄成増', '和光市']
['内幸町', '御成門', '日比谷', '芝公園', '霞ケ関', '銀座', '二重橋前', '神谷町', '新橋', '京橋', '東京', '東銀座', '大手町', '有楽町', '浜松町', '虎ノ門', '日本橋', '築地', '宝町', '三越前', '桜田門', '銀座一丁目', '田町', '茅場町', '人形町', '八丁堀', '水天宮前', '新富町', '高輪ゲートウェイ', '門前仲町', '清澄白河', '月島', '品川', '豊洲', '勝どき', '大崎', '辰巳', '築地市場', '新木場', '汐留']
['三田', '泉岳寺', '大門', '高輪台', '赤羽橋', '五反田', '戸越', '中延', '馬込', '西馬込']
['新宿西口', '東新宿', '都庁前', '西早稲田', '若松河田', '西新宿五丁目', '新宿', '雑司が谷', '牛込柳町', '中野坂上', '新大久保', '大久保', '西新宿', '牛込神楽坂', '新中野', '東中野', '高田馬場', '東高円寺', '中野', '中井', '目白', '落合', '早稲田', '新高円寺', '高円寺', '落合南長崎', '神楽坂', '南阿佐ケ谷', '阿佐ケ谷', '新江古田', '荻窪', '練馬', '西荻窪', '豊島園', '吉祥寺', '練馬春日町', '三鷹', '光が丘']
['北綾瀬', '綾瀬', '北千住', '南千住', '町屋', '三ノ輪', '西日暮里', '入谷', '日暮里', '千駄木', '上野', '鶯谷', '根津', '御徒町', '上野広小路', '仲御徒町', '湯島', '秋葉原', '末広町', '新御茶ノ水', '神田', '小伝馬町']
['原木中山', '妙典', '西船橋', '行徳', '船橋', '南行徳', '東船橋', '浦安', '津田沼', '葛西', '幕張本郷', '西葛西', '幕張', '南砂町', '新検見川', '東陽町', '稲毛', '木場', '西千葉', '千葉']
```

## 原理・アルゴリズム

SNSの課題で重みなしグラフについて[A Faster Algorithm for Betweenness Centrality](https://www.eecs.wsu.edu/~assefaw/CptS580-06/papers/brandes01centrality.pdf)の擬似コードを実装しましたが、重みありグラフに応用するためBFS部分をDijkstraにし、また中心媒介性を求める際始点から遠い地点から巻き戻して足し上げる必要があるためソート（transit_graph.pyの89行目）を加えました。（このソートのために計算量が $O( nm+n^2 )$ から $O(nm + n^2 \log n) $に増えました）